# Application
quarkus.application.name=achat-groupe
%dev.quarkus.http.port=8081

# Arc - keep handler beans (discovered dynamically by the mediator)
quarkus.arc.unremovable-types=fr.sqq.achatgroupe.application.handler.command.**,fr.sqq.achatgroupe.application.handler.query.**

# OpenAPI
quarkus.smallrye-openapi.store-schema-directory=target/openapi
quarkus.smallrye-openapi.info-title=Achat Groupe API
quarkus.smallrye-openapi.info-version=1.0.0
quarkus.smallrye-openapi.security-scheme=oidc
quarkus.smallrye-openapi.oidc-open-id-connect-url=https://placeholder/.well-known/openid-configuration

# Quinoa (Frontend)
quarkus.quinoa.package-manager-install=true
quarkus.quinoa.package-manager-install.node-version=22.22.0
quarkus.quinoa.package-manager-install.npm-version=11.7.0
quarkus.quinoa.dev-server.port=5173
quarkus.quinoa.build-dir=dist
quarkus.quinoa.enable-spa-routing=true

# Database - Dev Services
quarkus.datasource.db-kind=postgresql
quarkus.datasource.devservices.enabled=true
quarkus.datasource.devservices.reuse=false
%test.quarkus.datasource.devservices.reuse=false
quarkus.hibernate-orm.schema-management.strategy=validate
quarkus.flyway.migrate-at-start=true
%dev.quarkus.flyway.locations=db/migration,db/seed

# OIDC Configuration
quarkus.oidc.application-type=web-app
quarkus.oidc.authentication.redirect-path=/admin/
quarkus.oidc.logout.path=/api/admin/logout

stripe.api-key=sk_test_dummy
stripe.webhook-secret=dummy

# HTTP Auth Permissions - Admin (authenticated)
quarkus.http.auth.permission.admin.paths=/api/admin/*
quarkus.http.auth.permission.admin.policy=authenticated

# HTTP Auth Permissions - Public
quarkus.http.auth.permission.public.paths=/api/products/*,/api/ventes/*,/api/orders/*,/api/timeslots/*,/api/product-images/*
quarkus.http.auth.permission.public.policy=permit
quarkus.http.auth.permission.webhook.paths=/api/webhooks/*
quarkus.http.auth.permission.webhook.policy=permit

# App base URL (for URL validation)
app.base-url=${APP_BASE_URL:http://localhost:8080}

# Order settings
app.order.max-payment-attempts=2
app.order.abandon-timeout=30m

# Test profile
%test.app.base-url=http://localhost:8081
%test.quarkus.cucumber.glue=fr.sqq.achatgroupe.acceptance.steps
%test.quarkus.playwright.headless=true
%test.quarkus.datasource.devservices.enabled=true
%test.quarkus.quinoa=true
%test.quarkus.oidc.enabled=false
%test.quarkus.keycloak.devservices.enabled=false
%test.quarkus.http.auth.permission.admin-ventes.paths=/api/admin/ventes,/api/admin/ventes/*
%test.quarkus.http.auth.permission.admin-ventes.policy=permit


# Logging - JSON in production only
quarkus.log.json.enabled=false
%prod.quarkus.log.json.enabled=true

quarkus.keycloak.devservices.image-name=quay.io/keycloak/keycloak:26.5.3
quarkus.keycloak.devservices.keycloak-x-image=true